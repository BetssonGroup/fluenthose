[PARSER]
    Name cloudfront
    Format regex
    # 1607374321.541	127.0.0.1	0.042	200	485	GET	http	test.cloudfront.net	/i?stm=1607374321563&e=pp&url=http%253A%252F%252Flocalhost%253A5000%252Fpage-2&refr=http%253A%252F%252Flocalhost%253A5000%252F&pp_mix=0&pp_max=0&pp_miy=0&pp_may=0&tv=js-2.6.2&tna=cf&aid=site&p=web&tz=America%252FNew_York&lang=en-US&cs=UTF-8&res=3840x1600&cd=24&cookie=1&eid=d778127d-4ddf-4c04-90af-ffccc980eee8&dtm=1607374321561&vp=2450x1431&ds=2450x1431&vid=5&sid=a88ec782-713b-4e0d-b2da-c408e5730834&duid=eaa664f5-8ba9-41e9-9c98-a2ad088ca440&fp=2033130908	745	EWR52-C4	6PfZe0cc_AjXUjFuGnL9pGOmFdUx8xR8ZU8nr44JYJWi-DaeJjcxkw==	test.cloudfront.net	0.042	HTTP/1.1	IPv4	Mozilla/5.0%20(Macintosh;%20Intel%20Mac%20OS%20X%2010.15;%20rv:83.0)%20Gecko/20100101%20Firefox/83.0	http://localhost:5000/page-2	-	stm=1607374321563&e=pp&url=http%253A%252F%252Flocalhost%253A5000%252Fpage-2&refr=http%253A%252F%252Flocalhost%253A5000%252F&pp_mix=0&pp_max=0&pp_miy=0&pp_may=0&tv=js-2.6.2&tna=cf&aid=site&p=web&tz=America%252FNew_York&lang=en-US&cs=UTF-8&res=3840x1600&cd=24&cookie=1&eid=d778127d-4ddf-4c04-90af-ffccc980eee8&dtm=1607374321561&vp=2450x1431&ds=2450x1431&vid=5&sid=a88ec782-713b-4e0d-b2da-c408e5730834&duid=eaa664f5-8ba9-41e9-9c98-a2ad088ca440&fp=2033130908	Miss	-	-	-	Miss	-	-	image/gif	35	-	-	49323	Miss	US	gzip,%20deflate	image/webp,*/*	*	Host:test.cloudfront.net%0AUser-Agent:Mozilla/5.0%20(Macintosh;%20Intel%20Mac%20OS%20X%2010.15;%20rv:83.0)%20Gecko/20100101%20Firefox/83.0%0AAccept:image/webp,*/*%0AAccept-Language:en-US,en;q=0.5%0AAccept-Encoding:gzip,%20deflate%0ADNT:1%0AConnection:keep-alive%0AReferer:http://localhost:5000/page-2%0A	Host%0AUser-Agent%0AAccept%0AAccept-Language%0AAccept-Encoding%0ADNT%0AConnection%0AReferer%0A	8
    Regex ^(?<timestamp>[^\s]+)[\s]+(?<cIp>[^\s]+)[\s]+(?<timeToFirstByte>[^\s]+)[\s]+(?<scStatus>[^\s]+)[\s]+(?<scBytes>[^\s]+)[\s]+(?<csMethod>[^\s]+)[\s]+(?<csProtocol>[^\s]+)[\s]+(?<csHost>[^\s]+)[\s]+(?<csUriStem>[^\s]+)[\s]+(?<csBytes>[^\s]+)[\s]+(?<xEdgeLocation>[^\s]+)[\s]+(?<xEdgeRequestId>[^\s]+)[\s]+(?<xHostHeader>[^\s]+)[\s]+(?<timeTaken>[^\s]+)[\s]+(?<csProtocolVersion>[^\s]+)[\s]+(?<cIpVersion>[^\s]+)[\s]+(?<csUserAgent>[^\s]+)[\s]+(?<csReferer>[^\s]+)[\s]+(?<csCookie>[^\s]+)[\s]+(?<csUriQuery>[^\s]+)[\s]+(?<xEdgeResponseResultType>[^\s]+)[\s]+(?<xForwardedFor>[^\s]+)[\s]+(?<sslProtocol>[^\s]+)[\s]+(?<sslCipher>[^\s]+)[\s]+(?<xEdgeResultType>[^\s]+)[\s]+(?<fleEncryptedFields>[^\s]+)[\s]+(?<fleStatus>[^\s]+)[\s]+(?<scContentType>[^\s]+)[\s]+(?<scContentLen>[^\s]+)[\s]+(?<scRangeStart>[^\s]+)[\s]+(?<scRangeEnd>[^\s]+)[\s]+(?<cPort>[^\s]+)[\s]+(?<xEdgeDetailedResultType>[^\s]+)[\s]+(?<cCountry>[^\s]+)[\s]+(?<csAcceptEncoding>[^\s]+)[\s]+(?<csAccept>[^\s]+)[\s]+(?<cacheBehaviorPathPattern>[^\s]+)[\s]+(?<csHeaders>[^\s]+)[\s]+(?<csHeaderNames>[^\s]+)[\s]+(?<csHeadersCount>[^\s]+)$
    Time_Key timestamp
    Time_Format %s.%L

[PARSER]
    Name cloudwatchlogs
    Format json
    Time_Key message.timestamp
    Time_Format %s